"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[170],{7170:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var a=n(5043),o=n(8231),s=n(3727),r=n(5472),d=n(579);const i=function(){const[e,t]=(0,a.useState)([]),[n,i]=(0,a.useState)(null),[l,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(!0),p=(0,o.Zp)();(0,a.useEffect)((()=>{y()}),[]);const y=async()=>{try{const e=(0,r.P)((0,r.rJ)(s.db,"payment_settings"),(0,r.My)("amount","asc")),n=(await(0,r.GG)(e)).docs.map((e=>({id:e.id,...e.data(),value:e.id})));n.push({label:"\uae08\uc561 \uc9c1\uc811\uc785\ub825",value:"custom",amount:0}),t(n),n.length>0&&i(n[0].value),m(!1)}catch(e){console.error("Error loading payment options:",e),m(!1)}},h=()=>{var t;return"custom"===n?Number(l)||0:(null===(t=e.find((e=>e.value===n)))||void 0===t?void 0:t.amount)||0};function v(t){var a;const o="order_"+Date.now(),d=window.TossPayments("test_ck_GjLJoQ1aVZq1pAlkbomJ3w6KYe2R"),i=(null===(a=e.find((e=>e.value===n)))||void 0===a?void 0:a.label)||"\uc9c1\uc811\uc785\ub825";d.requestPayment("\uce74\ub4dc",{amount:t,orderId:o,orderName:i,customerName:"\ud14c\uc2a4\ud2b8\ud68c\uc6d0",successUrl:window.location.origin+"/payment/success",failUrl:window.location.origin+"/payment-fail"}).then((function(e){console.log("Payment result:",e),(async e=>{try{const t=s.j2.currentUser;if(!t)return void p("/login");const n=await(0,r.gS)((0,r.rJ)(s.db,"payments"),{amount:e.amount,paymentMethod:e.paymentMethod,timestamp:new Date,userId:t.uid,userName:t.displayName||"\uc0ac\uc6a9\uc790",orderId:e.orderId,status:"completed"});console.log("Payment saved with ID:",n.id),p("/payment/success",{state:{paymentId:n.id},replace:!0})}catch(t){console.error("Error saving payment:",t),alert("\uacb0\uc81c \uc815\ubcf4 \uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4.")}})({...e,orderId:o})})).catch((function(e){"USER_CANCEL"===e.code?alert("\uacb0\uc81c\uac00 \ucde8\uc18c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."):alert("\uacb0\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.\n"+e.message)}))}return u?(0,d.jsx)("div",{children:"\ub85c\ub529\uc911..."}):(0,d.jsxs)("div",{className:"payment-page-container",style:{maxWidth:400,margin:"40px auto",padding:20,background:"#fff",borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[(0,d.jsx)("h2",{children:"\uacb0\uc81c\ud558\uae30(\uc2dc\ud5d8\uc911\uc73c\ub85c\uc11c \uc9c0\uae08\uc740 \uacb0\uc81c\uac00 \uc774\ub8e8\uc5b4\uc9c0\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4)"}),(0,d.jsxs)("div",{style:{marginBottom:24},children:[e.map((e=>(0,d.jsx)("div",{style:{marginBottom:12},children:(0,d.jsxs)("label",{children:[(0,d.jsx)("input",{type:"radio",name:"paymentOption",value:e.value,checked:n===e.value,onChange:()=>i(e.value)}),e.label,"custom"!==e.value&&(0,d.jsxs)("span",{style:{marginLeft:8,color:"#888"},children:["(",e.amount.toLocaleString(),"\uc6d0)"]})]})},e.value))),"custom"===n&&(0,d.jsx)("div",{style:{marginTop:8},children:(0,d.jsx)("input",{type:"number",min:"9000",step:"1000",placeholder:"\uae08\uc561\uc744 \uc785\ub825\ud558\uc138\uc694 (\uc6d0)",value:l,onChange:e=>c(e.target.value),style:{width:"100%",padding:8,borderRadius:4,border:"1px solid #ccc"}})})]}),(0,d.jsx)("button",{onClick:()=>{const e=h();if(!window.TossPayments){const t=document.createElement("script");return t.src="https://js.tosspayments.com/v1/payment",t.async=!0,document.body.appendChild(t),t.onload=()=>{v(e)},void(t.onerror=()=>{alert("\uacb0\uc81c \ubaa8\ub4c8\uc744 \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.")})}v(e)},style:{width:"100%",padding:12,background:"#007bff",color:"#fff",border:"none",borderRadius:4,fontSize:16,cursor:"pointer"},disabled:h()<9e3,children:"\uacb0\uc81c\ud558\uae30"})]})}}}]);
//# sourceMappingURL=170.ad239b49.chunk.js.map