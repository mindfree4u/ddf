"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[611],{4611:(e,t,a)=>{a.r(t),a.d(t,{default:()=>l});var n=a(9950),o=a(4664),r=a(1693),s=a(6220),d=a(4414);const l=function(){const[e,t]=(0,n.useState)([]),[a,l]=(0,n.useState)(null),[i,c]=(0,n.useState)(""),[m,u]=(0,n.useState)(!0),p=(0,o.Zp)();(0,n.useEffect)((()=>{y()}),[]);const y=async()=>{try{const e=(0,s.P)((0,s.rJ)(r.db,"payment_settings"),(0,s.My)("amount","asc")),a=(await(0,s.GG)(e)).docs.map((e=>({id:e.id,...e.data(),value:e.id})));a.push({label:"\uae08\uc561 \uc9c1\uc811\uc785\ub825",value:"custom",amount:0}),t(a),a.length>0&&l(a[0].value),u(!1)}catch(e){console.error("Error loading payment options:",e),u(!1)}},h=()=>{var t;return"custom"===a?Number(i)||0:(null===(t=e.find((e=>e.value===a)))||void 0===t?void 0:t.amount)||0},g=t=>{var n,o;const s="order_"+Date.now(),d=(null===(n=e.find((e=>e.value===a)))||void 0===n?void 0:n.label)||"\uc9c1\uc811\uc785\ub825";window.TossPayments("test_ck_GjLJoQ1aVZq1pAlkbomJ3w6KYe2R").requestPayment("\uce74\ub4dc",{amount:t,orderId:s,orderName:d,customerName:(null===(o=r.j2.currentUser)||void 0===o?void 0:o.displayName)||"\uc0ac\uc6a9\uc790",successUrl:window.location.origin+"/payment/success",failUrl:window.location.origin+"/payment-fail"}).then((function(e){console.log("Payment result:",e),v({...e,orderId:s,paymentKey:e.paymentKey,amount:t,label:d,paymentMethod:"card"})})).catch((function(e){console.error("Payment error:",e),"USER_CANCEL"===e.code?alert("\uacb0\uc81c\uac00 \ucde8\uc18c\ub418\uc5c8\uc2b5\ub2c8\ub2e4."):alert("\uacb0\uc81c\uc5d0 \uc2e4\ud328\ud588\uc2b5\ub2c8\ub2e4.\n"+e.message)}))},v=async e=>{try{const n=r.j2.currentUser;if(!n)return void p("/login");console.log("Saving payment info:",{orderId:e.orderId,amount:e.amount,paymentMethod:e.paymentMethod,label:e.label});const o={label:e.label,amount:e.amount,paymentMethod:e.paymentMethod,timestamp:new Date,userId:n.uid,userName:n.displayName||"\uc0ac\uc6a9\uc790",orderId:e.orderId,paymentKey:e.paymentKey,status:"completed"};let d;try{d=await(0,s.gS)((0,s.rJ)(r.db,"payments"),o),console.log("Payment saved with ID:",d.id)}catch(t){console.error("Error saving payment to Firestore:",t)}await new Promise((e=>setTimeout(e,3e3)));const l=`/payment/success?orderId=${e.orderId}&paymentKey=${e.paymentKey}&amount=${e.amount}&paymentSettingId=${a}&paymentMethod=${e.paymentMethod}`;console.log("Navigating to:",l),p(l,{replace:!0})}catch(n){console.error("Error in handlePaymentSuccess:",n),alert("\uacb0\uc81c \uc815\ubcf4 \uc800\uc7a5 \uc911 \uc624\ub958\uac00 \ubc1c\uc0dd\ud588\uc2b5\ub2c8\ub2e4: "+n.message)}};return m?(0,d.jsx)("div",{children:"\ub85c\ub529\uc911..."}):(0,d.jsxs)("div",{className:"payment-page-container",style:{maxWidth:400,margin:"40px auto",padding:20,background:"#fff",borderRadius:8,boxShadow:"0 2px 8px rgba(0,0,0,0.08)"},children:[(0,d.jsx)("h2",{children:"\uacb0\uc81c\ud558\uae30(\uc2dc\ud5d8\uc911\uc73c\ub85c\uc11c \uc9c0\uae08\uc740 \uacb0\uc81c\uac00 \uc774\ub8e8\uc5b4\uc9c0\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4)"}),(0,d.jsxs)("div",{style:{marginBottom:24},children:[e.map((e=>(0,d.jsx)("div",{style:{marginBottom:12},children:(0,d.jsxs)("label",{children:[(0,d.jsx)("input",{type:"radio",name:"paymentOption",value:e.value,checked:a===e.value,onChange:()=>l(e.value)}),e.label,"custom"!==e.value&&(0,d.jsxs)("span",{style:{marginLeft:8,color:"#888"},children:["(",e.amount.toLocaleString(),"\uc6d0)"]})]})},e.value))),"custom"===a&&(0,d.jsx)("div",{style:{marginTop:8},children:(0,d.jsx)("input",{type:"number",min:"3000",step:"100",placeholder:"\uae08\uc561\uc744 \uc785\ub825\ud558\uc138\uc694 (\uc6d0)",value:i,onChange:e=>c(e.target.value),style:{width:"100%",padding:8,borderRadius:4,border:"1px solid #ccc"}})})]}),(0,d.jsx)("button",{onClick:()=>{const e=h();if(!window.TossPayments){const t=document.createElement("script");return t.src="https://js.tosspayments.com/v1/payment",t.async=!0,document.body.appendChild(t),t.onload=()=>{g(e)},void(t.onerror=()=>{alert("\uacb0\uc81c \ubaa8\ub4c8\uc744 \ubd88\ub7ec\uc624\uc9c0 \ubabb\ud588\uc2b5\ub2c8\ub2e4. \uc7a0\uc2dc \ud6c4 \ub2e4\uc2dc \uc2dc\ub3c4\ud574\uc8fc\uc138\uc694.")})}g(e)},style:{width:"100%",padding:12,background:"#007bff",color:"#fff",border:"none",borderRadius:4,fontSize:16,cursor:"pointer"},disabled:h()<3e3,children:"\uacb0\uc81c\ud558\uae30"})]})}}}]);